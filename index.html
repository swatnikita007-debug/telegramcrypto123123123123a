<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Galaxy Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: var(--tg-theme-bg-color);
            color: var(--tg-theme-text-color);
            transition: background-color 0.3s, color 0.3s;
        }
        h1 {
            color: var(--tg-theme-link-color);
        }
        button {
            background-color: var(--tg-theme-button-color);
            color: var(--tg-theme-button-text-color);
            border: none;
            padding: 10px 20px;
            margin: 10px 0;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
        }
        #user-info {
            background-color: var(--tg-theme-secondary-bg-color);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h1>‚ú® Crypto Galaxy Mini App</h1>

    <div id="user-info">
        <h3>üë§ –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ (–ü–æ–ª—É—á–µ–Ω—ã –∏–∑ SDK):</h3>
        <p id="tg-id">TG ID: –ó–∞–≥—Ä—É–∑–∫–∞...</p>
        <p id="first-name">–ò–º—è: –ó–∞–≥—Ä—É–∑–∫–∞...</p>
        <p id="username">Username: –ó–∞–≥—Ä—É–∑–∫–∞...</p>
    </div>

    <h2>üöÄ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
    <button onclick="requestBalance()">–ü–æ–∫–∞–∑–∞—Ç—å –±–∞–ª–∞–Ω—Å USDT –≤ —á–∞—Ç–µ</button>
    <button onclick="closeApp()">–ó–∞–∫—Ä—ã—Ç—å WebApp</button>

    <script>
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ WebApp
        if (window.Telegram.WebApp) {
            const WebApp = window.Telegram.WebApp;
            WebApp.ready();

            const user = WebApp.initDataUnsafe.user;
            
            // 1. –ü–û–õ–£–ß–ï–ù–ò–ï –î–ê–ù–ù–´–•
            document.getElementById('tg-id').innerText = 'TG ID: ' + user.id;
            document.getElementById('first-name').innerText = '–ò–º—è: ' + (user.first_name || 'N/A');
            document.getElementById('username').innerText = 'Username: ' + (user.username ? '@' + user.username : 'N/A');

            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—É—é –∫–Ω–æ–ø–∫—É WebApp
            WebApp.MainButton.text = "–û—Ç–∫—Ä—ã—Ç—å –ö–æ—à–µ–ª–µ–∫";
            WebApp.MainButton.show();
            WebApp.MainButton.onClick(openWallet);
            
            // 2. –û–¢–ü–†–ê–í–ö–ê –î–ê–ù–ù–´–• (–ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ MainButton)
            function openWallet() {
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ (payload) –±–æ—Ç—É, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –∫–æ–º–∞–Ω–¥—É
                const payload = {
                    action: 'open_wallet',
                    currency: 'USDT'
                };
                WebApp.sendData(JSON.stringify(payload));
                WebApp.close();
            }
            
            // 3. –û–¢–ü–†–ê–í–ö–ê –ö–û–ú–ê–ù–î–´ (–∏–∑ –æ–±—ã—á–Ω–æ–π –∫–Ω–æ–ø–∫–∏)
            function requestBalance() {
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–æ–º–∞–Ω–¥—É –±–æ—Ç—É, —á—Ç–æ–±—ã –æ–Ω –≤—ã–ø–æ–ª–Ω–∏–ª –¥–µ–π—Å—Ç–≤–∏–µ –≤ —á–∞—Ç–µ
                WebApp.HapticFeedback.notificationOccurred('success');
                WebApp.sendData(JSON.stringify({
                    action: 'request_balance',
                    user_id: user.id
                }));
                WebApp.close(); // –ó–∞–∫—Ä—ã–≤–∞–µ–º WebApp –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–º–∞–Ω–¥—ã
            }

            function closeApp() {
                WebApp.close();
            }

        } else {
            document.body.innerHTML = "<h2>–û—à–∏–±–∫–∞: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ Telegram.</h2>";
        }
    </script>
</body>
</html>